(this["webpackJsonpztickybar-publisher"]=this["webpackJsonpztickybar-publisher"]||[]).push([[0],{141:function(e,t){e.exports="data:image/png;base64,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"},142:function(e,t,n){var i=n(238),r={},o={tokenEndpoint:"https://login.microsoftonline.com/common/oauth2/token"};r.getAccessToken=function(){if(window)throw"Not valid client side";return new Promise((function(e,t){var n={grant_type:"client_credentials",client_id:o.clientId,client_secret:o.clientSecret,resource:"https://graph.microsoft.com"};i.post({url:o.tokenEndpoint,form:n},(function(n,i,r){var o=JSON.parse(r);n?t(n):o.error?t(o.error_description):e(o.access_token)}))}))},e.exports.getRaw=function(e,t){return console.log("getting",t),new Promise((function(n,r){i.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,i){if(e)return n({hasError:!0,error:e});n({hasError:!1,result:i})}))}))},e.exports.get=function(e,t){return new Promise((function(n,r){!function e(t,n,r,o,c,a){console.log("getting",n,!0===o),i.get({url:n,headers:{"content-type":"application/json",authorization:"Bearer "+t}},(function(i,s,l){var u,d;if(i){var p=a?a+1:1;return p>3?r(i,null,c):(console.log("retry #",p),e(t,n,r,o,c,p))}return(u=JSON.parse(l)).error?r(u.error,null,c):u["@odata.nextLink"]?(d=o?o.concat(u.value):u.value,e(t,u["@odata.nextLink"],r,d,c)):void(o?r(null,o.concat(u.value),c):u.value?r(null,u.value,c):r(null,u,c))}))}(e,t,(function(e,t){if(e)return r(e);n(t)}))}))},e.exports.post=function(e,t,n){return new Promise((function(r,o){!function(e,t,n,r){i.post({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var i;return e?r(e):(i=""===n?{}:JSON.parse(n)).error?r(i.error):void r(null,i)}))}(e,t,n,(function(e,t){if(e)return o(e);r(t)}))}))},e.exports.patch=function(e,t,n){return new Promise((function(r,o){!function(e,t,n,r){i.patch({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var i;return e?r(e):(i=""===n?{}:JSON.parse(n)).error?r(i.error):void r(null,i)}))}(e,t,n,(function(e,t){if(e)return o(e);r(t)}))}))},e.exports.auth=r},213:function(e){e.exports=JSON.parse('{"name":"ztickybar-publisher","version":"0.1.4","private":true,"dependencies":{"@microsoft/microsoft-graph-client":"^2.0.0","@uifabric/fluent-theme":"^7.1.4","animejs":"^3.1.0","axios":"^0.19.0","dexie":"^2.0.4","dexie-observable":"^1.0.0-beta.5","dexie-syncable":"^1.0.0-beta.4","exceljs":"^3.5.0","https":"^1.0.0","into-stream":"5.1.1","lodash":"^4.17.15","mammoth":"^1.4.9","moment":"^2.24.0","msal":"^1.2.1","office-ui-fabric-core":"^11.0.0","office-ui-fabric-react":"^7.61.1","quill-delta-to-html":"^0.11.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-grid-layout":"^0.17.1","react-resizable":"^1.10.1","react-scripts":"3.2.0","string-to-stream":"^3.0.1","xlsx":"^0.15.4","format-json":"^1.0.3"},"devDependencies":{"gh-pages":"^2.1.1"},"scripts":{"start":"PORT=3007 react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","config-default":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js","config-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js","deploy":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js && react-scripts build && gh-pages -b master -d build -r https://github.com/ztickybar/publish","deploy-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js && react-scripts build && echo publish.nets-intranets.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/nets-intranets/publish"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},230:function(e,t,n){e.exports=n(449)},235:function(e,t,n){},253:function(e,t){},255:function(e,t){},287:function(e,t){},288:function(e,t){},353:function(e,t){},447:function(e,t,n){},448:function(e,t){},449:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(31),c=n.n(o),a=(n(235),n(62)),s=n.n(a),l=n(96),u=n(26),d=n(211),p=n(212),f=(n(237),n(141)),m=n.n(f),g={clientId:"c69e0e4e-eb7b-4ea3-a9a9-d0837dced021",scopes:["user.readwrite","Sites.Read.All"],title:"Publisher",logo:m.a,model:{toolLists:[{graphUrl:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-tools:/lists/Links/items?expand=fields",webUrl:"https://christianiabpos.sharepoint.com/sites/intranets-tools/Lists/Links"}]},components:{header:r.a.createElement("div",{style:{borderBottom:"1px solid #cccccc"}},r.a.createElement("div",{style:{display:"flex",margin:"20px"}},r.a.createElement("div",null,r.a.createElement("img",{style:{height:"20px",padding:"4px"},src:m.a})),r.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"Publisher")))}},h=n(223),b=n(222);var w={getAccessToken:function(e){var t=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname;console.log("login replyUrl",t);var n={auth:{clientId:g.clientId,redirectUri:t,authority:"https://login.microsoftonline.com/common"}},i=new b.a(n);return new Promise(function(){var t=Object(l.a)(s.a.mark((function t(n,r){var o,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={scopes:e},i.handleRedirectCallback((function(e,t){})),t.prev=2,t.next=5,i.acquireTokenSilent(o);case 5:c=t.sent,n(c.accessToken),t.next=18;break;case 9:t.prev=9,t.t0=t.catch(2),t.t1=t.t0.errorCode,t.next="user_login_error"===t.t1?14:16;break;case 14:return i.loginRedirect(o),t.abrupt("break",17);case 16:return t.abrupt("break",17);case 17:r(t.t0);case 18:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,n){return t.apply(this,arguments)}}())}},v=n(142),A=n.n(v),x=(n(446),n(484)),j=n(10),k=n(487),E=n(104),y=n(8),O=n(479),G=n(63),S=n(470),Y=n(480),C=(n(447),n(213)),M=n(481);Object(h.a)();var U=function(){function e(){var t=this;Object(d.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){var i=window.self!==window.top?window.top:window.self;i&&i.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(p.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();function H(e,t,n){var i=e[n.fieldName];switch(n.key){case"iconUrl":return r.a.createElement("div",{style:{backgroundColor:e.color,marginTop:"-16px",height:"82px",width:"82px"}},r.a.createElement("div",{style:{margin:"16px"}},r.a.createElement("img",{src:i,style:{height:50}})));default:return r.a.createElement("span",null,i)}}function B(e){var t=Object(i.useState)(""),n=Object(u.a)(t,2),o=(n[0],n[1]),c=Object(i.useState)([]),a=Object(u.a)(c,2),s=a[0],l=a[1],d=Object(i.useState)([]),p=Object(u.a)(d,2),f=(p[0],p[1],Object(i.useState)(!1)),m=Object(u.a)(f,2),g=m[0],h=m[1],b=Object(i.useState)(0),w=Object(u.a)(b,2),v=w[0],A=w[1],C=Object(i.useState)([]),U=Object(u.a)(C,2),B=(U[0],U[1]),P=Object(i.useState)(null),I=Object(u.a)(P,2),D=(I[0],I[1]),R=Object(i.useState)(0),T=Object(u.a)(R,2),z=T[0],L=(T[1],new S.a({onSelectionChanged:function(e,t,n){var i=L.getSelectedCount();switch(B(L.getSelection()),i){case 0:return A(i),"No items selected";case 1:return A(i),"1 item selected: "+L.getSelection()[0].name;default:return A(i),"".concat(i," items selected")}}})),N=[],V=[];Object(i.useEffect)((function(){}),[z,v]);var F=[{key:"save",text:"Save",disabled:!g,iconProps:{iconName:"Save"},onClick:function(){h(!1)}},{key:"add",text:"Add",disabled:!1,iconProps:{iconName:"AddLink"},onClick:function(){o("add")}},{key:"view",text:"View",disabled:1!==v,iconProps:{iconName:"View"},onClick:function(){o("view")}},{key:"delete",text:"Delete",disabled:0===v,iconProps:{iconName:"RemoveLink"},onClick:function(){o("confirmDelete"),console.log("Deleting")}}];return r.a.createElement("div",null,s.length>0&&r.a.createElement(x.a,{messageBarType:j.a.error,isMultiline:!0,onDismiss:function(){l(s.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(s[0])),r.a.createElement(k.a,{scrollbarVisibility:E.b.auto},r.a.createElement(Y.a,{onRenderItemColumn:H,items:e.links,columns:[{key:"iconUrl",name:"Icon",fieldName:"iconUrl",minWidth:100,maxWidth:200,isResizable:!0},{key:"column1",name:"Name",fieldName:"title",isResizable:!0}],setKey:"set",layoutMode:y.e.justified,constrainMode:y.d.unconstrained,selection:L,selectionPreservedOnEmptyClick:!0,ariaLabelForSelectionColumn:"Toggle selection",ariaLabelForSelectAllCheckbox:"Toggle selection for all items",checkButtonAriaLabel:"Row checkbox",onItemInvoked:function(e,t,n){D(e),o("edit"),console.log("Invoked",e,t)},onRenderDetailsHeader:function(e,t){return r.a.createElement(O.a,{stickyPosition:G.a.Header,isScrollSynced:!0,stickyBackgroundColor:"transparent"},r.a.createElement(M.a,{items:F,farItems:N,overflowItems:V}),r.a.createElement("div",null,t(e)))}})))}U.init=function(){return new U};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(448);c.a.render(r.a.createElement((function(){var e=g.scopes,t=Object(i.useState)(!0),n=Object(u.a)(t,2),o=(n[0],n[1],Object(i.useState)([])),c=Object(u.a)(o,2),a=c[0],d=c[1],p=Object(i.useState)({}),f=Object(u.a)(p,2),m=f[0],h=f[1],b=Object(i.useState)([]),v=Object(u.a)(b,2),k=v[0],E=v[1],y=function(){try{return window.self!==window.top}catch(e){return!0}}(),O=Object(i.useState)(""),G=Object(u.a)(O,2),S=G[0],Y=G[1],M=Object(i.useState)(0),U=Object(u.a)(M,2),H=U[0],P=(U[1],Object(i.useState)(!1)),I=Object(u.a)(P,2);function D(){return(D=Object(l.a)(s.a.mark((function t(){var n,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.getAccessToken(e);case 3:return n=t.sent,Y(n),t.next=7,A.a.get(n,"https://graph.microsoft.com/v1.0/me");case 7:i=t.sent,h(i),t.next=22;break;case 11:t.prev=11,t.t0=t.catch(0),t.t1=t.t0.errorCode,t.next="user_login_error"===t.t1?16:18;break;case 16:case 18:return t.abrupt("break",20);case 20:a.push({context:" OfficeGraph.auth.getAccessToken()",error:t.t0}),d(a);case 22:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}return I[0],I[1],Object(i.useEffect)((function(){!function(){D.apply(this,arguments)}(),S&&A.a.get(S,g.model.toolLists[0].graphUrl).then((function(e){if(e){var t=e.map((function(e){try{return{id:e.fields.id,title:e.fields.Title,articleUrl:e.fields.Article_x0020_Page?e.fields.Article_x0020_Page.Url:null,iconUrl:e.fields.Icon?e.fields.Icon.Url:null,slug:e.fields.slug,color:e.fields.Color,textColor:e.fields.TextColor,message:e.fields.Message,toolbars:e.fields.Toolbars}}catch(t){a.push({context:"OfficeGraph.getLinks() map ",error:t}),d(a)}}));E(t)}})).catch((function(e){a.push({context:"OfficeGraph.getLinks() ",error:e}),d(a)}))}),[S,H]),r.a.createElement("div",{style:{position:"relative",height:"95vh"}},!y&&g.components&&g.components.header&&g.components.header,a.length>0&&r.a.createElement(x.a,{messageBarType:j.a.error,isMultiline:!1,onDismiss:function(){d(a.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(a[0])),r.a.createElement("div",{style:{backgroundColor:"#eeeeee"}},r.a.createElement("div",{style:{padding:"20px",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px",backgroundColor:"#ffffff",height:"80vh"}},r.a.createElement(B,{links:k}))),!y&&r.a.createElement("div",{style:{position:"absolute",bottom:0}},r.a.createElement("div",{style:{display:"flex",width:"100vw"}},r.a.createElement("div",{style:{flexGrow:1,padding:8}},m&&r.a.createElement("div",null,m.displayName," (",m.userPrincipalName,")"),g.alertsUrl&&r.a.createElement("a",{href:g.alertsUrl,target:"_blank"},g.alertsUrl)),r.a.createElement("div",null),r.a.createElement("div",{style:{padding:8,textAlign:"right"}},r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.jumpto365.com",target:"_blank"},"ZTICKYBAR Publisher")),r.a.createElement("div",null,"Version ",C.version)))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[230,1,2]]]);
//# sourceMappingURL=main.18e69ea8.chunk.js.map